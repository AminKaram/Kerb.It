<template name="ClientHistory">
  {{#OnlyConsumer}}
    {{>ClientHistoryHelper }}
  {{/OnlyConsumer}}
</template>

<template name="ClientHistoryHelper">
  <h3> You have {{getPendingCount}} jobs waiting for collection</h3>
    <table class="table table-hover">
  <thead>
    <tr>
      <th>Order ID</th>
      <th>Driver</th>
      <th>Location</th>
      <th>Collected?</th>
    </tr>
  </thead>
  <tbody>
  {{#each pending}}
    <tr>
      <th scope="row">{{_id}}</th>
      <td><img src="https://randomuser.me/api/portraits/men/8.jpg" style="width:35px;height:30px;">{{getDriverName driverId}}</td>
      <td>{{formatPostcode postcode}}</td>
      <td><button class="btn btn-default btn-success collect">Collected</button></td>
    </tr>
    {{/each}}

  </tbody>
</table>

    <h3> Your last five completed jobs :</h3>
    <table class="table table-hover">
        <thead>
        <tr>
            <th>Date</th>
            <th>Order ID</th>
            <th>Driver</th>
            <th>Location</th>
            <th>Feedback</th>
        </tr>
        </thead>
        <tbody>
        {{#each transactions}}
        <tr>
            <th>{{formatDate dateConfirmed}}</th>
            <th scope="row">{{_id}}</th>
            <td><img src="https://randomuser.me/api/portraits/men/8.jpg" style="width:35px;height:30px;">{{getDriverName driverId}}</td>
            <td>{{formatPostcode postcode}}</td>
            <td>
                {{#if hasFeedback _id}}
                    {{> starsRating rating=feedbackScore mutable=false}}
                {{else}}
                    {{> starsRating id='rating' mutable=true}}
                    <button class="btn btn-default ratingButton">Rate this transaction</button>
                {{/if}}
            </td>
        </tr>
        {{/each}}

        </tbody>
    </table>


</template>

